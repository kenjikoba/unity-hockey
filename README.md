# エアホッケー

## 概要
エアホッケーをAIでコントロールしよう、という問題です。エアホッケーでは、スマッシャーと呼ばれる器具を用いて盤上のパックと呼ばれる円盤を



台車の上に立てられた棒を，台車を左右に動かして倒さないようにする問題です．
台車が1軸上を左右に動けるものと平面上を自由に動けるものが用意されています．
配布されているプログラムでは，台車の座標や棒の角度を入力として，台車に加えるべき力の大きさが出力となるようにニューラルネットワーク（多層パーセプトロン）を，誤差逆伝播法（Back-Propagation）を用いて学習させています．

＜ソースコードの概要＞
Scenesフォルダ内のStage1が，台車が1軸上を左右に動けるもの，Stage2が平面上を自由に動けるものです．
Stage0では1軸上を動くものをキーボードの矢印キーの左右で操作できます．

自動運転プログラムなどと同様にAgent, NNBrain, NNEnvironment の3つのクラスで基本的に構成されています．（一部関数の名前が違ったりAgentが報酬を返さなかったりしますので注意してください．）
Agentが観測できる状態は，台車の座標・速度，棒の角度・角速度の4次元（Stage2では8次元）です．
Agentが取れる行動は，台車に力を加えることです．加える力は，-1～1の範囲の実数の1次元（Stage2では2次元）で指定できます．
棒が倒れてしまうか台車が範囲外に出てしまうとゲームオーバーです．
プログラム全体の流れは，NNEnvironment.csを見て，出てくるクラスや関数の実装をそれぞれ見ていって，コメントなども読めばわかりやすいと思います．
また，Stage2では教師信号の与え方が良くないので台車が範囲内にとどまるようには学習できません．
これを改良することをまず目指せば，プログラムの全体がつかめると思います．

注意．
配布プログラムでは学習前にニューラルネットワークの事前学習を行っています．実行環境によってはプログラムの開始をしてから画面が動き始めるまで時間がかかるかもしれません．その場合はBrainオブジェクトのEnablePreTrainのチェックを外すか，PreTrainNumの値を小さくしてください．